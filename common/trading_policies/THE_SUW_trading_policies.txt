propagate_religion = {
	unique = yes # Only one country can select this in a certain node.
	potential = {
		NOT = {
			OR = { # Should be th_is_touhou_religion = no, but some weird bug happens with that, so is explicit for now
				religion_group = Touhou
				religion_group = lunarian_religion_g
				religion = th_gensokirishitan
				religion = th_scarlet_christians
				religion = th_alukhuat
			}
		}
		NOT = { has_country_flag = disabled_trading_policy_propagate_religion }
	}
	can_select = {
		custom_trigger_tooltip = {
			tooltip = has_unlocked_trading_policy_propagate_religion_tt
			NOT = { has_country_flag = locked_trading_policy_propagate_religion }
		}
		OR = {
			religion_group = muslim
			religion_group = zoroastrian_group
			AND = {
				religion_group = dharmic
				mission_completed = mnd_maj_porch_of_mecca
			}
			custom_trigger_tooltip = {
				tooltip = can_use_propagate_religion_tt
				has_country_flag = can_use_propagate_religion
				#OR = {
				#	has_country_flag = can_use_propagate_religion
				#	has_government_attribute = can_propogate_religion
				#}
			}
			custom_trigger_tooltip = {
				tooltip = can_spread_reformation_tt
				AND = {
					#has_government_attribute = can_spread_the_reformation
					has_reform = reformer_state_reform
					OR = {
						current_age = age_of_discovery
						current_age = age_of_reformation
					}
				}
			}
		}
		if = {
			limit = { 
				NOT = { 
					has_country_flag = THE_SUW_suw_propagate_religion_flag 
				}  
			}
			dominant_religion = ROOT
		}
		
		if = { limit = { has_country_flag = 5_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 5 } } }
		else_if = { limit = { has_country_flag = 10_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 10 } } }
		else_if = { limit = { has_country_flag = 15_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 15 } } }
		else_if = { limit = { has_country_flag = 20_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 20 } } }
		else_if = { limit = { has_country_flag = 25_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 25 } } }
		else_if = { limit = { has_country_flag = 30_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 30 } } }
		else_if = { limit = { has_country_flag = 35_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 35 } } }
		else_if = { limit = { has_country_flag = 40_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 40 } } }
		else_if = { limit = { has_country_flag = 45_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 45 } } }
		else_if = { limit = { has_country_flag = THE_SUW_suw_propagate_religion_flag } FROM = { has_trader = ROOT trade_share = { country = ROOT share = 25 } } }
		else = { FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 50 } } }
	}

	can_maintain = {
		OR = {
			religion_group = muslim
			religion_group = zoroastrian_group
			AND = {
				religion_group = dharmic
				mission_completed = mnd_maj_porch_of_mecca
			}
			custom_trigger_tooltip = {
				tooltip = can_use_propagate_religion_tt
				has_country_flag = can_use_propagate_religion
				#OR = {
				#	has_country_flag = can_use_propagate_religion
				#	has_government_attribute = can_propogate_religion
				#}
			}
			custom_trigger_tooltip = {
				tooltip = can_spread_reformation_tt
				AND = {
					#has_government_attribute = can_spread_the_reformation
					has_reform = reformer_state_reform
					OR = {
						current_age = age_of_discovery
						current_age = age_of_reformation
					}
				}
			}
		}
		if = {
			limit = { 
				NOT = { 
					has_country_flag = THE_SUW_suw_propagate_religion_flag 
				}  
			}
			dominant_religion = ROOT
		}
		if = { limit = { has_country_flag = 5_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes } }
		else_if = { limit = { has_country_flag = 10_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 5 } } }
		else_if = { limit = { has_country_flag = 15_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 5 } } }
		else_if = { limit = { has_country_flag = 20_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 10 } } }
		else_if = { limit = { has_country_flag = 25_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 15 } } }
		else_if = { limit = { has_country_flag = 30_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 20 } } }
		else_if = { limit = { has_country_flag = 35_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 25 } } }
		else_if = { limit = { has_country_flag = 40_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 30 } } }
		else_if = { limit = { has_country_flag = 45_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 35 } } }
		else_if = { limit = { has_country_flag = THE_SUW_suw_propagate_religion_flag } FROM = { has_trader = ROOT trade_share = { country = ROOT share = 20 } } }
		else = { FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 40 } } }
	}

	show_alert = yes
	center_of_reformation = yes
	button_gfx = GFX_Trading_Policy_Propagate_Religion
}

touhou_propagate_religion = {
	unique = yes # Only one country can select this in a certain node.
	potential = {
		OR = { # Should be th_is_touhou_religion = yes, but some weird bug happens with that, so is explicit for now
			religion_group = Touhou
			religion_group = lunarian_religion_g
			religion = th_gensokirishitan
			religion = th_scarlet_christians
			religion = th_alukhuat
		}
	}
	can_select = {
		OR = { # Should be th_is_touhou_religion = yes, but some weird bug happens with that, so is explicit for now
			religion_group = Touhou
			religion_group = lunarian_religion_g
			religion = th_gensokirishitan
			religion = th_scarlet_christians
			religion = th_alukhuat
		}
		dominant_religion = ROOT
		if = { limit = { has_country_flag = 5_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 5 } } }
		else_if = { limit = { has_country_flag = 10_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 10 } } }
		else_if = { limit = { has_country_flag = 15_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 15 } } }
		else_if = { limit = { has_country_flag = 20_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 20 } } }
		else_if = { limit = { has_country_flag = 25_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 25 } } }
		else_if = { limit = { has_country_flag = 30_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 30 } } }
		else_if = { limit = { has_country_flag = 35_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 35 } } }
		else_if = { limit = { has_country_flag = 40_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 40 } } }
		else_if = { limit = { has_country_flag = 45_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 45 } } }
		else = { FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 50 } } }
		if = {
			limit = {
				religious_school = {
					group = Touhou
					school = byakuren_teachings
				}
			}
			NOT = {
				religious_school = {
					group = Touhou
					school = byakuren_teachings
				}
			}
		}
	}

	can_maintain = {
		OR = { # Should be th_is_touhou_religion = yes, but some weird bug happens with that, so is explicit for now
			religion_group = Touhou
			religion_group = lunarian_religion_g
			religion = th_gensokirishitan
			religion = th_scarlet_christians
			religion = th_alukhuat
		}
		dominant_religion = ROOT
		if = { limit = { has_country_flag = 5_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes } }
		else_if = { limit = { has_country_flag = 10_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 5 } } }
		else_if = { limit = { has_country_flag = 15_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 5 } } }
		else_if = { limit = { has_country_flag = 20_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 10 } } }
		else_if = { limit = { has_country_flag = 25_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 15 } } }
		else_if = { limit = { has_country_flag = 30_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 20 } } }
		else_if = { limit = { has_country_flag = 35_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 25 } } }
		else_if = { limit = { has_country_flag = 40_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 30 } } }
		else_if = { limit = { has_country_flag = 45_trade_power_for_propogate_religion } FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 35 } } }
		else = { FROM = { has_trader = ROOT is_node_in_trade_company_region = yes trade_share = { country = ROOT share = 40 } } }
		if = {
			limit = {
				religious_school = {
					group = Touhou
					school = byakuren_teachings
				}
			}
			NOT = {
				religious_school = {
					group = Touhou
					school = byakuren_teachings
				}
			}
		}
	}

	show_alert = yes
	center_of_reformation = yes
	button_gfx = GFX_Touhou_Trading_Policy_Propagate_Religion
}