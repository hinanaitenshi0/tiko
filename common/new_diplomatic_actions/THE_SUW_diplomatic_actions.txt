THE_SUW_ask_for_change_religions_to_moriyashinto = {
    category = th_diplo_action
    require_acceptance = yes
    is_visible = {
        religion = th_moriyashinto
        has_country_flag = THE_SUW_enable_diplomatic_change_religion_flag
    }
    is_allowed = {
        FROM = {
            NOT = {
                religion = th_moriyashinto
            }
        }
    }
    on_accept = {
        FROM = {
            change_religion = th_moriyashinto
        }
    }
    on_decline = {
    }
    ai_acceptance = {
        #基础-50
        add_entry = {
            name = TH_DIPENDENCE
            export_to_variable = {
                variable_name = ai_value
                value = -50
            }
        }
        #外交关系+0.15*value
        add_entry = {
            name = TH_DIPLO_OPPINION
            export_to_variable = {
                variable_name = ai_value
                value = opinion
                who = FROM
                with = ROOT
            }
            multiply_variable = {
                which = ai_value 
                value = 0.15
            }
        }
        #友好+10
		add_entry = {
			name = TH_DIPLO_FRI
			limit = {
				FROM = {
					ai_attitude = {
						who = ROOT
						attitude = attitude_friendly
					}
				}
			}
			export_to_variable = {
				variable_name = ai_value
				value = 10
			}
		}
        #同盟+15
		add_entry = {
			name = TH_DIPLO_ALLIENCE
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				variable_name = ai_value
				value = 15
			}
		}
        #宿敌或敌意-50
        add_entry = {
            name = TH_DIPLO_ENERMY
            limit = {
                FROM = {
                    OR = {
                        ai_attitude = {
                            who = ROOT
                            attitude = attitude_rivalry
                        }
                        ai_attitude = {
                            who = ROOT
                            attitude = attitude_hostile
                        }
                    }
                }
            }
            export_to_variable = {
                variable_name = ai_value
                value = -50
            }
        }
        #外交声誉+2.5*value
        add_entry = {
            name = TH_DIPLO_REPULATION
            export_to_variable = {
                variable_name = ai_value
                value = trigger_value:diplomatic_reputation
                who = ROOT
            }
            multiply_variable = {
                which = ai_value 
                value = 2.5
            }
        }
    }
}

heathen_royal_marriage = { #THE_SUW仿照版异教徒王室联姻
	category = dynasty

	alert_index = 1
	alert_tooltip = ICON_RM

	require_acceptance = yes

	is_visible = {
		FROM = {
			NOT = { religion_group = ROOT }
			NOT = { marriage_with = ROOT }
		}
		OR = {
			AND = {
				has_church_aspect = THE_SUW_2_2_aspect
				religion = THE_moriyaseikyou_religion
			}
			FROM = {
				has_church_aspect = THE_SUW_2_2_aspect
				religion = THE_moriyaseikyou_religion
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				NOT = { religion_group = ROOT }
				NOT = { marriage_with = ROOT }
			}
			OR = {
				AND = {
					has_government_attribute = can_royal_marry_heathens
					religion_group = christian
				}
				FROM = {
					has_government_attribute = can_royal_marry_heathens
					religion_group = christian
				}
			}
		}
		if = {
			limit = { war_with = FROM }
			custom_trigger_tooltip = {
				tooltip = HEATHEN_MARWAR
				NOT = { war_with = FROM }
			}
		}
		
		if = {
			limit = { FROM = { is_subject_other_than_tributary_trigger = yes is_lesser_in_union = no } }
			custom_trigger_tooltip = {
				tooltip = HEATHEN_MARVAS
				NOT = { FROM = { is_subject_other_than_tributary_trigger = yes } }
			}
		}
		if = {
			limit = { is_subject_other_than_tributary_trigger = yes is_lesser_in_union = no }
			custom_trigger_tooltip = {
				tooltip = HEATHEN_MARVAS
				NOT = { is_subject_other_than_tributary_trigger = yes }
			}
		}
		
		if = {
			limit = { FROM = { is_lesser_in_union = yes } }
			custom_trigger_tooltip = {
				tooltip = HEATHEN_MARJUN
				NOT = { FROM = { is_lesser_in_union = yes } }
			}
		}
		
	}

	on_accept = {
		force_create_marriage = FROM
	}

	on_decline = {
		add_opinion = {
			who = FROM
			modifier = opinion_refused_marriage
		}
	}

	ai_acceptance = {
		add_entry = {
			name = attitude_friendly_DIPLO_ATTITUDE_TT
			limit = { FROM = { ai_attitude = { who = ROOT attitude = attitude_friendly } } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = 40 }
		}
		add_entry = {
			name = attitude_protective_DIPLO_ATTITUDE_TT
			limit = { FROM = { ai_attitude = { who = ROOT attitude = attitude_protective } } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = 40 }
		}
		add_entry = {
			name = attitude_threatened_DIPLO_ATTITUDE_TT
			limit = { FROM = { ai_attitude = { who = ROOT attitude = attitude_threatened } } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = attitude_neutral_DIPLO_ATTITUDE_TT
			limit = { FROM = { ai_attitude = { who = ROOT attitude = attitude_neutral } } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -20 }
		}
		add_entry = {
			name = attitude_domineering_DIPLO_ATTITUDE_TT
			limit = { FROM = { ai_attitude = { who = ROOT attitude = attitude_domineering } } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -1000 }
		}
		add_entry = {
			name = attitude_hostile_DIPLO_ATTITUDE_TT
			limit = { FROM = { ai_attitude = { who = ROOT attitude = attitude_hostile } } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -1000 }
		}
		add_entry = {
			name = attitude_outraged_DIPLO_ATTITUDE_TT
			limit = { FROM = { ai_attitude = { who = ROOT attitude = attitude_outraged } } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -1000 }
		}
		add_entry = {
			name = attitude_rivalry_DIPLO_ATTITUDE_TT
			limit = { FROM = { ai_attitude = { who = ROOT attitude = attitude_rivalry } } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -1000 }
		}
		add_entry = {
			name = AI_DIPLOMATIC_REPUTATION
			export_to_variable = {
				variable_name = ai_value
				value = trigger_value:diplomatic_reputation
			}
			#1 rep = 3
			multiply_variable = {
				which = ai_value
				value = 5
			}
		}
        add_entry = {
            name = DIPLO_OPPINION
			export_to_variable = {
				variable_name = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			multiply_variable = {
				which = ai_value 
				value = 0.25
			}
        }
		add_entry = {
			name = DIPLO_SAME_CULTURE_GROUP
			limit = { FROM = { culture_group = ROOT } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = 20 }
		}
		add_entry = {
			name = DIPLO_SAME_RELIGION
			limit = { FROM = { religion = ROOT } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = DIPLO_MSG_FILTER_NEIGHBOURS
			limit = { FROM = { is_neighbor_of = ROOT } }
			export_to_variable = { variable_name = ai_value value = 1 }
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = DIPLO_BORDER_DISTANCE_TT
			export_to_variable = {
				variable_name = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			#2 units = -1
			multiply_variable = {
				which = ai_value
				value = -0.1
			}
		}
	}

	ai_will_do = {
		OR = {
			num_of_free_diplomatic_relations = 1
			alliance_with = FROM
			has_guaranteed = FROM
			FROM = { is_subject_of = ROOT }
		}
		OR = {
			ai_attitude = {
				who = FROM
				attitude = attitude_friendly
			}
			ai_attitude = {
				who = FROM
				attitude = attitude_loyal
			}
			ai_attitude = {
				who = FROM
				attitude = attitude_allied
			}
			ai_attitude = {
				who = FROM
				attitude = attitude_protective
			}
		}
		NOT = {
			ai_attitude = {
				who = FROM
				attitude = attitude_domineering
			}
		}
		NOT = {
			ai_attitude = {
				who = FROM
				attitude = attitude_hostile
			}
		}
		NOT = {
			ai_attitude = {
				who = FROM
				attitude = attitude_outraged
			}
		}
		has_opinion = {
			who = FROM
			value = 50
		}
	}
}
